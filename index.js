var g=Object.defineProperty;var f=(h,t,i)=>t in h?g(h,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):h[t]=i;var e=(h,t,i)=>(f(h,typeof t!="symbol"?t+"":t,i),i);class p{constructor(t){e(this,"effect");e(this,"pos");e(this,"speed");e(this,"history");e(this,"maxLength");e(this,"angle");e(this,"newAngle");e(this,"angleCorrector");e(this,"speedModifier");e(this,"timer");e(this,"color");e(this,"colors");this.effect=t,this.pos={x:Math.floor(Math.random()*this.effect.width),y:Math.floor(Math.random()*this.effect.height)},this.speed={x:0,y:0},this.speedModifier=Math.floor(Math.random()*2+1),this.history=[{x:this.pos.x,y:this.pos.y}],this.maxLength=Math.floor(Math.random()*30+2),this.angle=0,this.newAngle=0,this.angleCorrector=Math.random()*.5+.01,this.timer=this.maxLength*2,this.colors=["#0A2F50","#17395A","#204262","#2A4B68","#395A7F"],this.color=this.colors[Math.floor(Math.random()*this.colors.length)]}draw(t){t.beginPath(),t.moveTo(this.history[0].x,this.history[0].y);for(let i=0;i<this.history.length;i++)t.lineTo(this.history[i].x,this.history[i].y);t.strokeStyle=this.color,t.stroke()}update(){if(this.timer--,this.timer>=1){let t=Math.floor(this.pos.x/this.effect.cellSize),s=Math.floor(this.pos.y/this.effect.cellSize)*this.effect.cols+t;this.effect.flowField[s]&&(this.newAngle=this.effect.flowField[s].colorAngle,this.angle>this.newAngle?this.angle-=this.angleCorrector:this.angle<this.newAngle?this.angle+=this.angleCorrector:this.angle=this.newAngle),this.speed.x=Math.cos(this.angle),this.speed.y=Math.sin(this.angle),this.pos.x+=this.speed.x*this.speedModifier,this.pos.y+=this.speed.y*this.speedModifier,this.history.push({x:this.pos.x,y:this.pos.y}),this.history.length>this.maxLength&&this.history.shift()}else this.history.length>1?this.history.shift():this.reset()}reset(){let t=0,i=!1;for(;t<20&&!i;){t++;let s=Math.floor(Math.random()*this.effect.flowField.length);this.effect.flowField[s].alpha>0&&(this.pos={x:this.effect.flowField[s].x,y:this.effect.flowField[s].y},this.history=[{x:this.pos.x,y:this.pos.y}],this.timer=this.maxLength*2,i=!0)}i||(this.pos.x=Math.random()*this.effect.width,this.pos.y=Math.random()*this.effect.height,this.history=[{x:this.pos.x,y:this.pos.y}],this.timer=this.maxLength*2)}}class x{constructor(t,i){e(this,"canvas");e(this,"height");e(this,"width");e(this,"particles");e(this,"totalParticles");e(this,"cellSize");e(this,"rows");e(this,"cols");e(this,"flowField",[]);e(this,"debug");e(this,"firstRun");e(this,"text");e(this,"textInput");e(this,"totalParticlesInput");e(this,"ctx");this.canvas=t,this.ctx=i,this.height=this.canvas.height,this.width=this.canvas.width,this.particles=[],this.totalParticles=2e3,this.cellSize=1,this.rows=0,this.cols=0,this.flowField=[],this.debug=!1,this.text="Flow",this.firstRun=!0,this.render(),this.textInput=document.getElementById("text-input"),this.totalParticlesInput=document.getElementById("total-particles-input"),this.textInput.value=this.text,this.totalParticlesInput.value=this.totalParticles.toString(),this.textInput.oninput=o=>{let l=o.target;this.text=l.value,this.firstRun=!0},this.totalParticlesInput.oninput=o=>{let l=o.target;this.totalParticles=Number(l.value),this.firstRun=!0},window.addEventListener("keydown",o=>{o.key==="D"&&(this.debug=!this.debug)}),window.addEventListener("resize",o=>{const l=o.target;this.resize(l.innerWidth,l.innerHeight)});const s=document.getElementById("toggle-btn"),r=document.getElementById("control-menu");s.onclick=()=>{r.classList.toggle("display")}}drawText(){this.ctx.font="500px Impact",this.ctx.textAlign="center",this.ctx.textBaseline="middle";const t=this.ctx.createRadialGradient(this.width*.5,this.height*.5,1,this.width*.5,this.height*.5,this.width);t.addColorStop(0,"rgb(2,0,36"),t.addColorStop(.01,"rgb(121,39,9)"),t.addColorStop(.05,"rgb(109,89,33)"),t.addColorStop(.09,"rgb(71,100,52)"),t.addColorStop(.12," rgb(56,123,94)"),t.addColorStop(.17,"rgb(42,145,134)"),t.addColorStop(.2,"rgb(29,165,171)"),t.addColorStop(.23,"rgb(23,82,188)"),t.addColorStop(.26,"rgb(73,15,210)"),t.addColorStop(.3,"rgb(202,50,224)"),t.addColorStop(.4,"rgb(224,50,179)"),t.addColorStop(.45,"rgb(224,50,109)"),this.ctx.fillStyle=t,this.ctx.fillText(this.text,this.width*.5,this.height*.5,Math.floor(this.width*.8))}init(){this.particles=[],this.rows=Math.floor(this.height/this.cellSize),this.cols=Math.floor(this.width/this.cellSize),this.flowField=[],this.drawText();const t=this.ctx.getImageData(0,0,this.width,this.height).data;for(let i=0;i<this.height;i+=this.cellSize)for(let s=0;s<this.width;s+=this.cellSize){const r=(i*this.width+s)*4,o=t[r+0],l=t[r+1],a=t[r+2],n=t[r+3],c=(o+l+a)/3,d=Number((c/255*6.28).toFixed(2));this.flowField.push({x:s,y:i,colorAngle:d,alpha:n})}for(let i=0;i<this.totalParticles;i++)this.particles.push(new p(this));this.particles.forEach(i=>i.reset())}drawGrid(){this.ctx.save(),this.ctx.strokeStyle="white",this.ctx.lineWidth=.3;for(let t=0;t<this.cols;t++)this.ctx.beginPath(),this.ctx.moveTo(this.cellSize*t,0),this.ctx.lineTo(this.cellSize*t,this.height),this.ctx.stroke();for(let t=0;t<this.rows;t++)this.ctx.beginPath(),this.ctx.moveTo(0,this.cellSize*t),this.ctx.lineTo(this.width,this.cellSize*t),this.ctx.stroke();this.ctx.restore()}render(){this.debug&&(this.drawGrid(),this.drawText()),this.firstRun&&(this.firstRun=!1,this.init()),this.particles.forEach(t=>{t.update(),t.draw(this.ctx)})}resize(t,i){this.canvas.width=t,this.canvas.height=i,this.width=this.canvas.width,this.height=this.canvas.height,this.render()}}window.onload=()=>{const h=document.getElementById("app-canvas"),t=h.getContext("2d",{});h.width=window.innerWidth||600,h.height=window.innerHeight||600,t.getContextAttributes().willReadFrequently=!0,t.fillStyle="white",t.strokeStyle="white",t.lineWidth=1;const i=new x(h,t);function s(){t.clearRect(0,0,h.width,h.height),i.render(),requestAnimationFrame(s)}s()};
